!**********************************************************************
!   System:                  O4
!   Functional form:           permutation-invariant polynomials
!   Common name:              O4 singlet (adiabatic ground state)
!   Number of derivatives:      1
!   Number of bodies:          4
!   Number of electronic surfaces: 1
!   Interface: Section-2
!
!   References: Y. Paukku, K. R. Yang, Z. Varga, G. Song, J. D. Bender,
!   D. G. Truhlar J. Chem. Phys. 147, 034301/1-11 (2017) 
!
!   Notes:    PES of singlet O4 with special emphasize for
!            O2 + O2 --> O2 + O + O
!           - Fit is based on extended dataset
!            containing 12684 points
!           - Mixed-exponential- gaussian (MEG)
!            variables are applied to describe the 
!            long-range interactions   
!           - D3 dispersion correction is implemented for diatoms
!
!     O1--O2
!
!     O3--O4
!
!
!
!   Input: X(4),Y(4),Z(4)             in unit of bohr
!   Output: E                        in unit of hartree
!   Output: dEdX(4),dEdY(4),dEdZ(4)     hartree/bohr
!
!**********************************************************************

      module PES_O4_singlet_umn_v1

!**********************************************************************
! This code is based on O4_singlet.f (FORTRAN77 version) where some
! keywords were replaced by more modern ones.
!
! The dispersion term is called inside the subroutine ev2gm2
! for each diatomic term.
!
! Otherwise the surface itself was not changed.
!**********************************************************************

      implicit none 
      private
      public :: pot, ev2gm2

! Conversion factors
! Cconv: bohr to Angstrom 
!       1 bohr = 0.52917721092 angstrom
! Econv: kcal/mol to hartree 
!       1 kcal/mol = 0.159360144 * 10^-2 hartree
! Gconv: kcal/(mol*Angstrom) to hartree/bohr
!       1 kcal mol^-1 angstrom^-1 = 0.843297564 * 10^-3 hartree/bohr

      double precision,parameter :: Cconv = 0.52917721092d0
      double precision,parameter :: Econv = 0.159360144d-2
      double precision,parameter :: Gconv = 0.843297564d-3

! Common variables
! R(6):        Interatomic bond distance
! rMs(6)		Array to store base terms
! rM(0:111) 	Array to store monomials
! P(0:465) 		Array to store polynomials
! B(1:430)     	Array to store basis functions
! dMsdR(6,6):   The derivative of base terms w.r.t. R
! dMdR(6,112):  The derivative of monomials w.r.t. R
! dPdR(6,466):  The derivative of basis functions w.r.t. R
! dVdR(6):      The derivative of V w.r.t. R
! dRdX(6,12):   The derivative of R w.r.t. X
! dBdR(6,430)	The derivative of B w.r.t. R 
	  
      double precision :: R(6)
      double precision :: rMs(6),rM(0:111),P(0:465),B(430)
      double precision :: dMsdR(6,6),dMdR(6,0:111),dPdR(6,0:465)
      double precision :: dVdR(6),dRdX(6,12),dBdR(6,430)
	  
! Nonlinear parameters:
! a(in Ang)
! ab (in Ang^2)
! ra (in Ang)
! and rb (in Ang)

      double precision,parameter :: a  = 0.9d0
      double precision,parameter :: ab = 4.5d0 
      double precision,parameter :: ra = 1.3d0  
      double precision,parameter :: rb = 1.1d0

! Reference energy of infinitely separated O2 + O2 in hartree (taken
! from calculations)
      double precision,parameter :: Eref = -299.833226d0

! For O2 + O2 framework total diss. energy is 2*120.243 kcal/mol 
      double precision,parameter :: totdiss = 240.486d0

! Linear parameters optimized by the weighted-least square fitting
      double precision,parameter :: C(430) = (/ &
       0.298592612739D+03 ,-0.125579224756D+04 ,-0.346335550266D+04 &
      ,-0.294702322940D+03 ,-0.296577191243D+03 , 0.965792810044D+04 &
      ,-0.549110140441D+02 , 0.136716400726D+04 , 0.126185289217D+04 &
      , 0.993715889892D+04 , 0.802105115234D+03 ,-0.181853596929D+04 &
      ,-0.143880900954D+03 ,-0.889574687877D+04 ,-0.114890690860D+05 &
      ,-0.127257185242D+05 , 0.510350987746D+04 , 0.364292608425D+04 &
      , 0.787503439878D+03 ,-0.328850842648D+04 ,-0.112393903565D+05 &
      ,-0.509316981409D+04 , 0.149912659431D+04 , 0.571731000213D+04 &
      ,-0.205041906521D+05 , 0.291245356735D+04 , 0.453625779030D+04 &
      ,-0.549007585953D+03 ,-0.874596036408D+04 , 0.142213978373D+05 &
      ,-0.331069808214D+04 ,-0.100352590684D+05 , 0.151888735135D+05 &
      , 0.122551074571D+05 , 0.530544483747D+04 ,-0.177196059292D+05 &
      ,-0.405277982979D+04 , 0.141195806551D+05 , 0.109440841330D+05 &
      ,-0.205349003163D+04 , 0.350530984208D+03 , 0.820953107979D+04 &
      , 0.673211067462D+05 , 0.215379655342D+05 ,-0.593405799893D+04 &
      ,-0.129690044177D+02 ,-0.245758611767D+04 ,-0.230104075092D+04 &
      , 0.427911961579D+04 ,-0.302933139796D+04 ,-0.134447689198D+05 &
      , 0.318953773748D+05 ,-0.132787758074D+05 ,-0.636180323642D+04 &
      , 0.107806525300D+04 , 0.578759928629D+03 ,-0.783261557315D+04 &
      ,-0.330673892004D+05 ,-0.263621908182D+05 , 0.154958804740D+05 &
      , 0.177163731743D+05 ,-0.115574194414D+05 ,-0.366050419172D+05 &
      , 0.190594139987D+04 , 0.172298792741D+05 ,-0.877173614010D+04 &
      ,-0.199513498660D+05 , 0.104229190909D+05 ,-0.191553017793D+05 &
      ,-0.972187594591D+04 ,-0.790285972889D+04 ,-0.189535519115D+05 &
      , 0.460239401136D+04 , 0.127374546673D+05 , 0.752663940489D+04 &
      , 0.134673487637D+05 ,-0.147047548727D+05 , 0.118828168482D+05 &
      ,-0.646372893354D+03 ,-0.459482029264D+04 , 0.906908559777D+04 &
      ,-0.687075118556D+04 ,-0.675228854396D+04 ,-0.466880627533D+05 &
      ,-0.133163987314D+05 , 0.278589549401D+04 , 0.439154773546D+04 &
      ,-0.231481937914D+04 , 0.714892600850D+04 , 0.261522419231D+04 &
      , 0.810923624996D+04 , 0.168971327378D+05 ,-0.172998152752D+04 &
      , 0.418748984564D+03 , 0.138643866637D+05 ,-0.366311219780D+05 &
      , 0.175353484409D+05 , 0.242169948213D+04 ,-0.100639013420D+05 &
      , 0.183349949215D+04 ,-0.259425525571D+04 , 0.229746182459D+05 &
      ,-0.346562717405D+05 , 0.356838595060D+04 , 0.843137337287D+04 &
      ,-0.295856322028D+05 , 0.275706239869D+04 , 0.134150273092D+05 &
      , 0.223062864415D+05 ,-0.666494045982D+04 ,-0.285171739099D+05 &
      , 0.841382599878D+04 , 0.163923888983D+05 , 0.309435461164D+05 &
      ,-0.326976411505D+05 , 0.179133065095D+05 ,-0.756291977876D+04 &
      , 0.140550227317D+05 ,-0.153491667373D+04 , 0.174879587088D+05 &
      , 0.137280463030D+05 ,-0.214485434972D+05 ,-0.270966455377D+05 &
      ,-0.235859441946D+05 , 0.187591808449D+05 ,-0.513756538760D+02 &
      , 0.490994880708D+04 ,-0.682235493754D+04 , 0.108141922806D+05 &
      , 0.407840596563D+04 , 0.800968818552D+04 ,-0.457870258791D+04 &
      ,-0.579399656691D+04 , 0.150668857355D+05 , 0.306334695997D+03 &
      , 0.139048084725D+05 ,-0.916426956205D+04 , 0.582775211022D+03 &
      , 0.284520470233D+04 ,-0.310352049112D+05 , 0.955841430686D+04 &
      ,-0.194509778782D+05 ,-0.751436867037D+04 , 0.700170122108D+04 &
      , 0.214926005784D+04 , 0.987503897784D+04 ,-0.197270085287D+04 &
      , 0.173414581582D+04 ,-0.591371831249D+04 , 0.164368277844D+04 &
      ,-0.667372277041D+04 , 0.521417369835D+05 , 0.134013044510D+05 &
      ,-0.898782810507D+04 ,-0.341208044228D+04 ,-0.467954363833D+04 &
      , 0.360875928317D+03 ,-0.387759391973D+04 , 0.266897214494D+04 &
      ,-0.232304532139D+04 ,-0.235248633016D+05 ,-0.125997226275D+04 &
      , 0.150218156318D+04 ,-0.106400542767D+05 , 0.304500483494D+05 &
      ,-0.939615722060D+04 , 0.145396142055D+04 , 0.145289076874D+04 &
      , 0.909967462064D+04 ,-0.303258346224D+04 ,-0.182630157835D+05 &
      ,-0.835187460531D+05 , 0.109120836406D+06 ,-0.157712324052D+05 &
      , 0.755839443367D+04 ,-0.857078488570D+04 ,-0.307695798840D+05 &
      , 0.197156956256D+05 ,-0.180064192716D+04 ,-0.749753066453D+04 &
      , 0.295203595875D+05 ,-0.131326966178D+05 ,-0.239557176450D+05 &
      , 0.178288929499D+05 , 0.488169051480D+04 , 0.147961068675D+05 &
      ,-0.235059030850D+05 ,-0.453616125465D+04 ,-0.285061345499D+05 &
      ,-0.125669171799D+05 , 0.126915369966D+05 , 0.368430918451D+04 &
      , 0.115387367791D+05 , 0.107338423334D+05 , 0.143665939943D+05 &
      ,-0.213674766678D+05 ,-0.159998428235D+05 , 0.689512414156D+04 &
      ,-0.648072888087D+04 , 0.115624148525D+05 , 0.124896686257D+05 &
      , 0.705405675525D+04 ,-0.286817478526D+05 ,-0.136258689344D+05 &
      , 0.390746718202D+04 , 0.102032257023D+05 ,-0.417281840798D+04 &
      , 0.148293120508D+05 , 0.126335743739D+05 , 0.134971822596D+05 &
      ,-0.114279120920D+05 , 0.408739687151D+04 , 0.131928327852D+04 &
      ,-0.132091135618D+05 ,-0.837869825780D+04 ,-0.136136372449D+05 &
      ,-0.159522278515D+05 , 0.129658463107D+05 , 0.141143269555D+05 &
      , 0.185207210136D+03 ,-0.119516113416D+05 ,-0.197501953548D+04 &
      , 0.124307707708D+05 , 0.378244070605D+04 ,-0.457854103481D+04 &
      ,-0.423814562714D+04 ,-0.106470321410D+05 ,-0.230460180997D+04 &
      ,-0.371214482336D+04 , 0.453640245575D+04 , 0.677825461707D+04 &
      ,-0.104697271294D+05 , 0.304070982774D+04 ,-0.578602168093D+04 &
      , 0.821898511083D+04 ,-0.849259449518D+03 ,-0.463228963750D+04 &
      , 0.169021270913D+05 ,-0.469518028437D+04 , 0.120488124404D+05 &
      , 0.841130544857D+04 ,-0.450766758497D+04 ,-0.543234225552D+04 &
      ,-0.404747113317D+05 ,-0.469171381726D+04 , 0.302008480732D+04 &
      ,-0.378482086925D+03 ,-0.392762423402D+04 ,-0.176336590427D+04 &
      , 0.119140454170D+05 ,-0.239850568844D+04 , 0.127687629618D+04 &
      ,-0.144254458645D+04 , 0.453496274499D+04 , 0.130854375779D+04 &
      , 0.203593304317D+04 , 0.721631738669D+04 ,-0.344844633060D+05 &
      ,-0.633318286223D+04 , 0.702743443183D+04 , 0.197686380216D+04 &
      , 0.180883435348D+04 ,-0.705980006263D+03 , 0.103195938916D+04 &
      ,-0.492057803524D+04 ,-0.168526889271D+04 , 0.150404802773D+05 &
      , 0.106690165919D+04 ,-0.900002022916D+03 , 0.527435786753D+04 &
      ,-0.153754615776D+05 , 0.193952452007D+04 ,-0.778909488801D+03 &
      ,-0.219012750009D+04 ,-0.284739770520D+04 , 0.162114609888D+04 &
      , 0.111390102848D+06 ,-0.757717321484D+04 , 0.919969731783D+04 &
      ,-0.756031076135D+04 ,-0.350275679904D+05 , 0.821193104109D+04 &
      ,-0.470475781719D+04 , 0.777903479548D+04 , 0.132492696207D+05 &
      , 0.103374948267D+05 ,-0.193063213672D+05 ,-0.317396308830D+05 &
      , 0.306400459901D+04 ,-0.206724375171D+04 , 0.356461680915D+04 &
      ,-0.884135234187D+04 , 0.310596525101D+04 ,-0.379646991249D+04 &
      , 0.248580314671D+05 , 0.578393223080D+04 ,-0.135280567174D+05 &
      , 0.759277858738D+04 , 0.145362031903D+04 , 0.183577733210D+04 &
      , 0.121717322760D+05 ,-0.815148207793D+04 ,-0.269856886458D+04 &
      , 0.299718399041D+04 ,-0.933086794212D+04 ,-0.118165449086D+04 &
      , 0.522405943360D+04 ,-0.214196449174D+05 , 0.920205043478D+04 &
      ,-0.212972813520D+05 , 0.255548442912D+04 ,-0.879267955553D+04 &
      , 0.475229788826D+03 ,-0.797432737589D+04 ,-0.421208417118D+04 &
      , 0.336115300014D+04 ,-0.202545012661D+04 ,-0.199967532545D+04 &
      , 0.762277534968D+04 ,-0.975809566289D+04 , 0.156000631334D+05 &
      , 0.553704675908D+04 ,-0.133523782908D+05 ,-0.106626650189D+05 &
      ,-0.203337059827D+04 , 0.887589429131D+04 ,-0.607893446727D+04 &
      , 0.240430906464D+04 ,-0.267555834783D+04 , 0.584944963442D+04 &
      ,-0.268584385090D+04 ,-0.582509421577D+04 ,-0.502932698880D+04 &
      ,-0.203054226303D+04 , 0.397374963678D+04 , 0.369426751903D+04 &
      ,-0.672352726836D+04 , 0.269527948680D+04 ,-0.292453344094D+04 &
      ,-0.400014873976D+04 , 0.118881666241D+05 , 0.543526408988D+04 &
      ,-0.623735050284D+04 , 0.524364610599D+04 ,-0.395883009927D+03 &
      ,-0.111722018325D+04 , 0.267466984436D+04 ,-0.408016636802D+04 &
      ,-0.310725959832D+04 , 0.148132614302D+04 ,-0.208398217925D+04 &
      ,-0.273121034682D+04 , 0.544046965079D+04 , 0.423600618408D+04 &
      , 0.479266739610D+04 ,-0.778823436146D+02 , 0.452384845890D+02 &
      ,-0.133366625257D+04 ,-0.293599276843D+03 ,-0.454427054890D+04 &
      , 0.270598891410D+04 , 0.552204664286D+04 ,-0.157033467525D+04 &
      , 0.196478344393D+04 ,-0.851776887360D+04 ,-0.305744696543D+04 &
      ,-0.627476974195D+03 , 0.300606738375D+04 ,-0.277071019143D+04 &
      ,-0.845274829899D+04 ,-0.315748163381D+04 , 0.281706004360D+04 &
      , 0.701293131865D+03 , 0.655679777621D+04 ,-0.285456961357D+04 &
      , 0.231092297949D+04 ,-0.294612871896D+04 , 0.101775855472D+04 &
      , 0.299536076000D+04 ,-0.158056831601D+04 , 0.203388131615D+04 &
      ,-0.131052079153D+04 ,-0.708487453210D+03 , 0.303903943130D+04 &
      ,-0.390538324686D+04 , 0.148279230791D+04 ,-0.361905690247D+04 &
      ,-0.243027866495D+04 , 0.107257023808D+04 ,-0.118984040018D+04 &
      , 0.137402215587D+04 ,-0.337208796865D+03 , 0.361802463625D+04 &
      , 0.168370369350D+03 , 0.367168099308D+03 ,-0.510762868571D+04 &
      ,-0.528441548214D+03 ,-0.459708455166D+03 , 0.650073835021D+03 &
      , 0.441881857786D+03 , 0.201872111883D+03 ,-0.214144124355D+03 &
      , 0.126503163460D+04 ,-0.115771714175D+04 , 0.274975605687D+03 &
      , 0.586690681828D+03 ,-0.902909201679D+03 , 0.873626603924D+01 &
      ,-0.119171512041D+04 ,-0.156115800920D+04 , 0.674995356592D+04 &
      , 0.903081501277D+03 ,-0.152277477378D+04 ,-0.235321544270D+03 &
      ,-0.949184352249D+03 , 0.392765218347D+02 ,-0.138851065929D+03 &
      , 0.163912938887D+04 , 0.397802757345D+03 ,-0.325204893631D+04 &
      ,-0.960710143625D+01 , 0.162168042183D+03 ,-0.101113002473D+04 &
      , 0.323985190964D+04 ,-0.142539188439D+03 ,-0.162527222435D+01 &
      , 0.327255262039D+03 , 0.560850412626D+03 , 0.230770119412D+03 &
      ,-0.300763627841D+03                                     &
      /)

      contains


      subroutine o4pes(X,v,dVdX,igrad)
      !**********************************************************************
      ! Subroutine to calculate the potential energy V and gradient dVdX
      ! for given Cartesian coordinate X(12)  
      ! R:           Interatomic bond distance (6)
      ! V:           Calculated potential energy
      ! dVdX:        The derivative of V w.r.t. X, dim(12)
      ! dVdR:        The derivative of V w.r.t. R, dim(6) 
      ! dPdR:        The derivative of basis functions w.r.t. R
      !             dim(6*466)
      ! dMdR:        The derivative of monomials w.r.t. R
      !             dim(6*112)
      ! dRdX:        The derivative of R w.r.t. X, dim(6*12)
      !**********************************************************************

      integer i,igrad,j,nob,k
      double precision V
      double precision dVdX(12),X(12) 


      if (igrad .le. 1) then
! Call subroutine EvV to evaluate potential energy V
       call evv(V)

       if (igrad .eq. 1) then
! Call EvdVdX to evaluate the derivatives of V w.r.t. X
         call evdvdr
       endif
      else
       write (*,*) 'Only igrad = 0, 1 is allowed!'
      endif

      E = v*Econv + Eref

      end subroutine o4pes


      subroutine EvV(V)
!**********************************************************************
! Subroutine to evaluate V for giving R 
! V(R) = C*P
! C:           Coefficients, stored in 'dim.inc' 
! P:           Basis functions evaluated for giving R
! rMs:         rMs(6), six mixed exponetial gaussian terms (MEG)
! a:           Nonlinear parameters in Morse terms(Angstrom)
! ab:          Nonlinear parameters in Gauss terms(Angstrom^2)
! re:          Equilibrium bond length(Angstrom)
! nop:         number of points
! nom:         number of monomials
! nob:         number of basis functions(polynomials)
! rM(0:111):    Array to store monomials
! P(0:465):     Array to store polynomials
! B(1:430):     Array to store basis functions
!**********************************************************************
      
      integer i,j,k
      double precision dist,dv2dr,V,V2,disp,dispdr(6)

! Calculate the six MEG terms for each point
      call evmorse

! Calculate the monomials for each point by using six MEG terms
      call evmono

! Calculate the polynomials (basis functions) by using monomials
      call evpoly 

! Calculate the basis functions by removing unconnected and 2-body terms
      call evbas

! Initialized v to be totdiss
      v=totdiss
! Evaluate 2-body interactions
      do i=1,6
       dist=r(i)
       call ev2gm2(dist,v2,dv2dr,4,0)
       v=v+v2
      enddo

!! D3 dispersion correction is called inside the ev2gm2 !!
! Add D3 dispersion correction
!      call d3disp(r,disp,dispdr,0)
!      v=v+disp

! Evaluate V by taken the product of C and Basis function array
      do i=1,430
       v=v + c(i)*b(i)
      enddo

!      Write(*,9999) V 
! 9999 Format('The potential energy is ',F20.14,' kcal/mol')

      return

      end subroutine EvV


      subroutine EvMorse
!**********************************************************************      
! mixed exponential gaussian term ms = exp(-(r-re)/a-(r-re)^2/ab)
! re:   equlibrium bond length(1.208A)
! a:    nonlinear paramter optimized for diatomic molecules, unit
! Anstrom
! ab:   nonlinear paramter optimized for diatomic molecules, unit
! Anstrom^2
!**********************************************************************
      integer i

      do i=1,6
        rms(i)=Exp(-(r(i) - ra)/a-((r(i) - rb)**2.0d0)/ab)
      enddo

      end subroutine EvMorse


      subroutine EvMono
!**********************************************************************
!  The subroutine reads six MEG variables(X) and calculate the
!  monomials(M) that do not have usable decomposition.
!  For A4 with max. degree 10, the number of monomials is nom.
!**********************************************************************

      rm(0) = 1.0d0
      rm(1) = rms(6)
      rm(2) = rms(5)
      rm(3) = rms(4)
      rm(4) = rms(3)
      rm(5) = rms(2)
      rm(6) = rms(1)
      rm(7) = rm(3)*rm(4)
      rm(8) = rm(2)*rm(5)
      rm(9) = rm(1)*rm(6)
      rm(10) = rm(1)*rm(2)
      rm(11) = rm(1)*rm(3)
      rm(12) = rm(2)*rm(3)
      rm(13) = rm(1)*rm(4)
      rm(14) = rm(2)*rm(4)
      rm(15) = rm(1)*rm(5)
      rm(16) = rm(3)*rm(5)
      rm(17) = rm(4)*rm(5)
      rm(18) = rm(2)*rm(6)
      rm(19) = rm(3)*rm(6)
      rm(20) = rm(4)*rm(6)
      rm(21) = rm(5)*rm(6)
      rm(22) = rm(1)*rm(7)
      rm(23) = rm(2)*rm(7)
      rm(24) = rm(1)*rm(8)
      rm(25) = rm(2)*rm(16)
      rm(26) = rm(2)*rm(17)
      rm(27) = rm(3)*rm(17)
      rm(28) = rm(1)*rm(18)
      rm(29) = rm(1)*rm(19)
      rm(30) = rm(1)*rm(20)
      rm(31) = rm(3)*rm(20)
      rm(32) = rm(1)*rm(21)
      rm(33) = rm(2)*rm(21)
      rm(34) = rm(1)*rm(12)
      rm(35) = rm(1)*rm(17)
      rm(36) = rm(2)*rm(20)
      rm(37) = rm(3)*rm(21)
      rm(38) = rm(1)*rm(14)
      rm(39) = rm(1)*rm(16)
      rm(40) = rm(2)*rm(19)
      rm(41) = rm(4)*rm(21)
      rm(42) = rm(2)*rm(27)
      rm(43) = rm(1)*rm(31)
      rm(44) = rm(1)*rm(33)
      rm(45) = rm(1)*rm(23)
      rm(46) = rm(1)*rm(25)
      rm(47) = rm(1)*rm(26)
      rm(48) = rm(1)*rm(27)
      rm(49) = rm(1)*rm(40)
      rm(50) = rm(1)*rm(36)
      rm(51) = rm(2)*rm(31)
      rm(52) = rm(1)*rm(37)
      rm(53) = rm(2)*rm(37)
      rm(54) = rm(1)*rm(41)
      rm(55) = rm(2)*rm(41)
      rm(56) = rm(3)*rm(41)
      rm(57) = rm(1)*rm(42)
      rm(58) = rm(1)*rm(51)
      rm(59) = rm(1)*rm(53)
      rm(60) = rm(1)*rm(55)
      rm(61) = rm(1)*rm(56)
      rm(62) = rm(2)*rm(56)
      rm(63) = rm(1)*rm(62)
      rm(64) = rm(2)*rm(57)
      rm(65) = rm(3)*rm(57)
      rm(66) = rm(4)*rm(57)
      rm(67) = rm(5)*rm(57)
      rm(68) = rm(1)*rm(58)
      rm(69) = rm(3)*rm(58)
      rm(70) = rm(4)*rm(58)
      rm(71) = rm(1)*rm(59)
      rm(72) = rm(2)*rm(59)
      rm(73) = rm(1)*rm(60)
      rm(74) = rm(2)*rm(60)
      rm(75) = rm(1)*rm(61)
      rm(76) = rm(2)*rm(62)
      rm(77) = rm(3)*rm(61)
      rm(78) = rm(3)*rm(62)
      rm(79) = rm(4)*rm(61)
      rm(80) = rm(4)*rm(62)
      rm(81) = rm(5)*rm(59)
      rm(82) = rm(5)*rm(60)
      rm(83) = rm(5)*rm(62)
      rm(84) = rm(6)*rm(58)
      rm(85) = rm(6)*rm(59)
      rm(86) = rm(6)*rm(60)
      rm(87) = rm(6)*rm(61)
      rm(88) = rm(2)*rm(64)
      rm(89) = rm(3)*rm(65)
      rm(90) = rm(4)*rm(66)
      rm(91) = rm(5)*rm(67)
      rm(92) = rm(1)*rm(68)
      rm(93) = rm(3)*rm(69)
      rm(94) = rm(4)*rm(70)
      rm(95) = rm(1)*rm(71)
      rm(96) = rm(2)*rm(72)
      rm(97) = rm(1)*rm(73)
      rm(98) = rm(2)*rm(74)
      rm(99) = rm(1)*rm(75)
      rm(100) = rm(2)*rm(76)
      rm(101) = rm(3)*rm(77)
      rm(102) = rm(3)*rm(78)
      rm(103) = rm(4)*rm(79)
      rm(104) = rm(4)*rm(80)
      rm(105) = rm(5)*rm(81)
      rm(106) = rm(5)*rm(82)
      rm(107) = rm(5)*rm(83)
      rm(108) = rm(6)*rm(84)
      rm(109) = rm(6)*rm(85)
      rm(110) = rm(6)*rm(86)
      rm(111) = rm(6)*rm(87)

      return

      end subroutine EvMono

      subroutine EvPoly
!**********************************************************************
!  The subroutine reads monomials(m) and calculate the
!  permutation invariant polynomials(p)
!  For A4 with max. degree 10, the number of polynomials is nob.
!**********************************************************************

      p(0) = rm(0)
      p(1) = rm(1) + rm(2) + rm(3) + rm(4) + rm(5) + rm(6)
      p(2) = rm(7) + rm(8) + rm(9)
      p(3) = rm(10) + rm(11) + rm(12) + rm(13) + rm(14) + rm(15) &
          + rm(16) + rm(17) + rm(18) + rm(19) + rm(20) + rm(21)
      p(4) = p(1)*p(1) - p(3) - p(2) - p(3) - p(2)
      p(5) = rm(22) + rm(23) + rm(24) + rm(25) + rm(26) + rm(27) &
          + rm(28) + rm(29) + rm(30) + rm(31) + rm(32) + rm(33)
      p(6) = rm(34) + rm(35) + rm(36) + rm(37)
      p(7) = rm(38) + rm(39) + rm(40) + rm(41)
      p(8) = p(1)*p(2) - p(5)
      p(9) = p(1)*p(3) - p(6) - p(7) - p(5) - p(6) &
           - p(7) - p(5) - p(6) - p(7)
      p(10) = p(1)*p(4) - p(9) - p(8)
      p(11) = rm(42) + rm(43) + rm(44)
      p(12) = rm(45) + rm(46) + rm(47) + rm(48) + rm(49) + rm(50) + rm(51) + rm(52) + rm(53) + rm(54) + rm(55) + rm(56)
      p(13) = p(2)*p(3) - p(12)
      p(14) = p(1)*p(5) - p(12) - p(11) - p(13) - p(12) &
           - p(11) - p(11) - p(11)
      p(15) = p(1)*p(6) - p(12)
      p(16) = p(1)*p(7) - p(12)
      p(17) = p(2)*p(2) - p(11) - p(11)
      p(18) = p(3)*p(3) - p(12) - p(11) - p(15) - p(16) &
           - p(14) - p(12) - p(11) - p(15) - p(16) - p(14) &
           - p(12) - p(11) - p(12) - p(11)
      p(19) = p(2)*p(4) - p(14)
      p(20) = p(3)*p(4) - p(15) - p(16) - p(13)
      p(21) = p(1)*p(10) - p(20) - p(19)
      p(22) = rm(57) + rm(58) + rm(59) + rm(60) + rm(61) + rm(62)
      p(23) = p(1)*p(11) - p(22)
      p(24) = p(2)*p(6)
      p(25) = p(2)*p(7)
      p(26) = p(1)*p(12) - p(22) - p(24) - p(25) - p(22) &
           - p(22) - p(22)
      p(27) = p(2)*p(5) - p(22) - p(23) - p(22)
      p(28) = p(3)*p(5) - p(22) - p(26) - p(24) - p(25) &
           - p(23) - p(22) - p(24) - p(25) - p(23) - p(22) &
           - p(22)
      p(29) = p(3)*p(6) - p(22) - p(26) - p(22)
      p(30) = p(3)*p(7) - p(22) - p(26) - p(22)
      p(31) = p(2)*p(9) - p(26) - p(28)
      p(32) = p(1)*p(14) - p(26) - p(23) - p(28)
      p(33) = p(4)*p(6) - p(25)
      p(34) = p(4)*p(7) - p(24)
      p(35) = p(1)*p(17) - p(27)
      p(36) = p(1)*p(18) - p(29) - p(30) - p(28)
      p(37) = p(2)*p(10) - p(32)
      p(38) = p(3)*p(10) - p(33) - p(34) - p(31)
      p(39) = p(1)*p(21) - p(38) - p(37)
      p(40) = rm(63)
      p(41) = rm(64) + rm(65) + rm(66) + rm(67) + rm(68) + rm(69) + rm(70) + rm(71) + rm(72) + rm(73) + rm(74) + rm(75) + rm(76) + rm(77) + rm(78) + rm(79) + rm(80) + rm(81) + rm(82) + rm(83) + rm(84) + rm(85) + rm(86) + rm(87)
      p(42) = p(1)*p(22) - p(40) - p(41) - p(40) - p(40) &
           - p(40) - p(40) - p(40)
      p(43) = p(2)*p(11) - p(40) - p(40) - p(40)
      p(44) = p(2)*p(12) - p(41)
      p(45) = p(3)*p(11) - p(41)
      p(46) = p(5)*p(6) - p(41)
      p(47) = p(5)*p(7) - p(41)
      p(48) = p(6)*p(7) - p(40) - p(40) - p(40) - p(40)
      p(49) = p(4)*p(11) - p(42)
      p(50) = p(2)*p(15) - p(46)
      p(51) = p(2)*p(16) - p(47)
      p(52) = p(4)*p(12) - p(41) - p(50) - p(51)
      p(53) = p(2)*p(14) - p(42) - p(49) - p(42)
      p(54) = p(6)*p(6) - p(42) - p(42)
      p(55) = p(7)*p(7) - p(42) - p(42)
      p(56) = p(3)*p(17) - p(44)
      p(57) = p(2)*p(18) - p(48)
      p(58) = p(3)*p(14) - p(41) - p(52) - p(46) - p(47) &
           - p(45) - p(45)
      p(59) = p(6)*p(9) - p(41) - p(52) - p(47)
      p(60) = p(7)*p(9) - p(41) - p(52) - p(46)
      p(61) = p(2)*p(20) - p(52) - p(58)
      p(62) = p(1)*p(32) - p(52) - p(49) - p(58)
      p(63) = p(6)*p(10) - p(51)
      p(64) = p(7)*p(10) - p(50)
      p(65) = p(2)*p(17) - p(43)
      p(66) = p(3)*p(18) - p(46) - p(47) - p(45) - p(59) &
           - p(60) - p(58)
      p(67) = p(2)*p(19) - p(49)
      p(68) = p(1)*p(36) - p(59) - p(60) - p(58) - p(57) &
           - p(66) - p(66)
      p(69) = p(2)*p(21) - p(62)
      p(70) = p(3)*p(21) - p(63) - p(64) - p(61)
      p(71) = p(1)*p(39) - p(70) - p(69)
      p(72) = p(40)*p(1)
      p(73) = p(2)*p(22) - p(72)
      p(74) = p(6)*p(11)
      p(75) = p(7)*p(11)
      p(76) = p(3)*p(22) - p(72) - p(74) - p(75) - p(72) &
           - p(72) - p(72)
      p(77) = rm(88) + rm(89) + rm(90) + rm(91) + rm(92) + rm(93) + rm(94) + rm(95) + rm(96) + rm(97) + rm(98) + rm(99) + rm(100) + rm(101) + rm(102) + rm(103) + rm(104) + rm(105) + rm(106) + rm(107) + rm(108) + rm(109) + rm(110) + rm(111)
      p(78) = p(1)*p(42) - p(72) - p(76)
      p(79) = p(5)*p(11) - p(72) - p(73) - p(72)
      p(80) = p(2)*p(26) - p(76) - p(77)
      p(81) = p(6)*p(12) - p(72) - p(76) - p(72)
      p(82) = p(7)*p(12) - p(72) - p(76) - p(72)
      p(83) = p(8)*p(11) - p(72)
      p(84) = p(6)*p(17)
      p(85) = p(7)*p(17)
      p(86) = p(9)*p(11) - p(76) - p(77)
      p(87) = p(2)*p(29) - p(81)
      p(88) = p(6)*p(14) - p(75) - p(75)
      p(89) = p(2)*p(30) - p(82)
      p(90) = p(7)*p(14) - p(74) - p(74)
      p(91) = p(1)*p(48) - p(76) - p(81) - p(82)
      p(92) = p(10)*p(11) - p(78)
      p(93) = p(2)*p(33) - p(88)
      p(94) = p(2)*p(34) - p(90)
      p(95) = p(10)*p(12) - p(77) - p(93) - p(94)
      p(96) = p(2)*p(27) - p(73) - p(79)
      p(97) = p(2)*p(28) - p(76) - p(86)
      p(98) = p(1)*p(53) - p(80) - p(79) - p(97)
      p(99) = p(1)*p(54) - p(81)
      p(100) = p(1)*p(55) - p(82)
      p(101) = p(5)*p(18) - p(76) - p(91) - p(87) - p(89) - p(86)
      p(102) = p(6)*p(18) - p(74) - p(90)
      p(103) = p(7)*p(18) - p(75) - p(88)
      p(104) = p(2)*p(31) - p(77) - p(86)
      p(105) = p(2)*p(36) - p(91) - p(101)
      p(106) = p(3)*p(32) - p(77) - p(95) - p(88) - p(90) - p(86)
      p(107) = p(4)*p(29) - p(82) - p(80) - p(99)
      p(108) = p(4)*p(30) - p(81) - p(80) - p(100)
      p(109) = p(2)*p(38) - p(95) - p(106)
      p(110) = p(1)*p(62) - p(95) - p(92) - p(106)
      p(111) = p(6)*p(21) - p(94)
      p(112) = p(7)*p(21) - p(93)
      p(113) = p(1)*p(65) - p(96)
      p(114) = p(1)*p(66) - p(102) - p(103) - p(101)
      p(115) = p(2)*p(37) - p(92)
      p(116) = p(10)*p(18) - p(99) - p(100) - p(97)
      p(117) = p(2)*p(39) - p(110)
      p(118) = p(3)*p(39) - p(111) - p(112) - p(109)
      p(119) = p(1)*p(71) - p(118) - p(117)
      p(120) = p(40)*p(2)
      p(121) = p(40)*p(3)
      p(122) = p(40)*p(4)
      p(123) = p(11)*p(12) - p(121)
      p(124) = p(2)*p(42) - p(122)
      p(125) = p(6)*p(22) - p(121)
      p(126) = p(7)*p(22) - p(121)
      p(127) = p(2)*p(41) - p(121) - p(123) - p(121)
      p(128) = p(6)*p(23) - p(123)
      p(129) = p(7)*p(23) - p(123)
      p(130) = p(3)*p(41) - p(122) - p(121) - p(120) - p(125) - p(128) - p(126) - p(129) - p(124) - p(123) - p(122) - p(121) - p(120) - p(125) - p(126) - p(124) - p(123) - p(122) - p(121) - p(120) - p(122) - p(121) - p(120) - p(120) - p(120) - p(120) - p(120)
      p(131) = p(3)*p(42) - p(121) - p(125) - p(126) - p(121)
      p(132) = p(4)*p(41) - p(121) - p(131) - p(128) - p(129) - p(127) - p(121)
      p(133) = p(1)*p(78) - p(122) - p(131)
      p(134) = p(11)*p(11) - p(120) - p(120)
      p(135) = p(2)*p(48) - p(130)
      p(136) = p(11)*p(17) - p(120)
      p(137) = p(2)*p(44) - p(123)
      p(138) = p(2)*p(45) - p(121)
      p(139) = p(11)*p(14) - p(122) - p(124) - p(122)
      p(140) = p(6)*p(27) - p(127)
      p(141) = p(2)*p(54)
      p(142) = p(7)*p(27) - p(127)
      p(143) = p(2)*p(52) - p(131) - p(132)
      p(144) = p(1)*p(81) - p(125) - p(141) - p(135) - p(125)
      p(145) = p(2)*p(55)
      p(146) = p(1)*p(82) - p(126) - p(135) - p(145) - p(126)
      p(147) = p(11)*p(18) - p(130)
      p(148) = p(6)*p(28) - p(129) - p(123) - p(143)
      p(149) = p(7)*p(28) - p(128) - p(123) - p(143)
      p(150) = p(6)*p(30) - p(121) - p(146)
      p(151) = p(11)*p(19) - p(122)
      p(152) = p(2)*p(50) - p(128)
      p(153) = p(2)*p(51) - p(129)
      p(154) = p(11)*p(20) - p(131) - p(132)
      p(155) = p(2)*p(59) - p(144) - p(148)
      p(156) = p(6)*p(32) - p(129)
      p(157) = p(2)*p(60) - p(146) - p(149)
      p(158) = p(7)*p(32) - p(128)
      p(159) = p(6)*p(34) - p(122) - p(145) - p(122)
      p(160) = p(11)*p(21) - p(133)
      p(161) = p(2)*p(63) - p(156)
      p(162) = p(2)*p(64) - p(158)
      p(163) = p(12)*p(21) - p(132) - p(161) - p(162)
      p(164) = p(2)*p(53) - p(124) - p(139)
      p(165) = p(2)*p(58) - p(131) - p(154)
      p(166) = p(3)*p(54) - p(125) - p(144)
      p(167) = p(3)*p(55) - p(126) - p(146)
      p(168) = p(3)*p(65) - p(137)
      p(169) = p(17)*p(18) - p(135)
      p(170) = p(1)*p(98) - p(143) - p(139) - p(165)
      p(171) = p(4)*p(54) - p(135)
      p(172) = p(4)*p(55) - p(135)
      p(173) = p(2)*p(66) - p(150)
      p(174) = p(1)*p(101) - p(148) - p(149) - p(147) - p(173) - p(165) - p(147)
      p(175) = p(1)*p(102) - p(150) - p(148) - p(166)
      p(176) = p(1)*p(103) - p(150) - p(149) - p(167)
      p(177) = p(2)*p(61) - p(132) - p(154)
      p(178) = p(2)*p(68) - p(159) - p(174)
      p(179) = p(3)*p(62) - p(132) - p(163) - p(156) - p(158) - p(154)
      p(180) = p(6)*p(38) - p(132) - p(163) - p(157)
      p(181) = p(7)*p(38) - p(132) - p(163) - p(155)
      p(182) = p(2)*p(70) - p(163) - p(179)
      p(183) = p(1)*p(110) - p(163) - p(160) - p(179)
      p(184) = p(6)*p(39) - p(162)
      p(185) = p(7)*p(39) - p(161)
      p(186) = p(2)*p(65) - p(136)
      p(187) = p(3)*p(66) - p(148) - p(149) - p(147) - p(175) - p(176) - p(174)
      p(188) = p(2)*p(67) - p(151)
      p(189) = p(4)*p(66) - p(166) - p(167) - p(165)
      p(190) = p(2)*p(69) - p(160)
      p(191) = p(18)*p(21) - p(171) - p(172) - p(169)
      p(192) = p(2)*p(71) - p(183)
      p(193) = p(3)*p(71) - p(184) - p(185) - p(182)
      p(194) = p(1)*p(119) - p(193) - p(192)
      p(195) = p(40)*p(5)
      p(196) = p(40)*p(6)
      p(197) = p(40)*p(7)
      p(198) = p(40)*p(8)
      p(199) = p(40)*p(9)
      p(200) = p(40)*p(10)
      p(201) = p(11)*p(22) - p(195)
      p(202) = p(12)*p(22) - p(196) - p(197) - p(195) - p(196) - p(197) - p(195) - p(196) - p(197)
      p(203) = p(17)*p(22) - p(198)
      p(204) = p(6)*p(43)
      p(205) = p(7)*p(43)
      p(206) = p(11)*p(26) - p(199) - p(202)
      p(207) = p(2)*p(76) - p(199) - p(202)
      p(208) = p(2)*p(78) - p(200)
      p(209) = p(6)*p(41) - p(199) - p(195) - p(202) - p(195)
      p(210) = p(6)*p(42) - p(197) - p(197) - p(197)
      p(211) = p(7)*p(41) - p(199) - p(195) - p(202) - p(195)
      p(212) = p(7)*p(42) - p(196) - p(196) - p(196)
      p(213) = p(11)*p(29) - p(209)
      p(214) = p(11)*p(30) - p(211)
      p(215) = p(18)*p(22) - p(199) - p(213) - p(214)
      p(216) = p(2)*p(77) - p(199) - p(206)
      p(217) = p(6)*p(49) - p(205)
      p(218) = p(7)*p(49) - p(204)
      p(219) = p(3)*p(77) - p(200) - p(199) - p(198) - p(209) - p(217) - p(211) - p(218) - p(207) - p(204) - p(205) - p(200) - p(199) - p(198) - p(200) - p(198) - p(200) - p(198)
      p(220) = p(3)*p(78) - p(199) - p(210) - p(212)
      p(221) = p(10)*p(41) - p(199) - p(220) - p(217) - p(218) - p(216)
      p(222) = p(1)*p(133) - p(200) - p(220)
      p(223) = p(11)*p(27) - p(195) - p(203)
      p(224) = p(1)*p(134) - p(201)
      p(225) = p(2)*p(81) - p(209)
      p(226) = p(2)*p(80) - p(202) - p(206)
      p(227) = p(2)*p(82) - p(211)
      p(228) = p(2)*p(91) - p(215) - p(219)
      p(229) = p(11)*p(28) - p(199) - p(207)
      p(230) = p(6)*p(53) - p(205)
      p(231) = p(5)*p(54) - p(209)
      p(232) = p(7)*p(53) - p(204)
      p(233) = p(7)*p(54) - p(196)
      p(234) = p(5)*p(55) - p(211)
      p(235) = p(6)*p(55) - p(197)
      p(236) = p(11)*p(35) - p(198)
      p(237) = p(6)*p(65)
      p(238) = p(7)*p(65)
      p(239) = p(2)*p(86) - p(199) - p(229)
      p(240) = p(1)*p(139) - p(206) - p(229) - p(224)
      p(241) = p(17)*p(29) - p(225)
      p(242) = p(2)*p(99) - p(231)
      p(243) = p(17)*p(30) - p(227)
      p(244) = p(2)*p(95) - p(220) - p(221)
      p(245) = p(4)*p(81) - p(202) - p(242) - p(227)
      p(246) = p(2)*p(100) - p(234)
      p(247) = p(4)*p(82) - p(202) - p(225) - p(246)
      p(248) = p(11)*p(36) - p(215) - p(219)
      p(249) = p(2)*p(102) - p(233)
      p(250) = p(6)*p(58) - p(206) - p(214) - p(244) - p(214)
      p(251) = p(2)*p(103) - p(235)
      p(252) = p(7)*p(58) - p(213) - p(206) - p(244) - p(213)
      p(253) = p(1)*p(150) - p(215) - p(233) - p(235)
      p(254) = p(11)*p(37) - p(200)
      p(255) = p(2)*p(93) - p(217)
      p(256) = p(2)*p(94) - p(218)
      p(257) = p(11)*p(38) - p(220) - p(221)
      p(258) = p(2)*p(107) - p(245) - p(250)
      p(259) = p(6)*p(62) - p(218)
      p(260) = p(2)*p(108) - p(247) - p(252)
      p(261) = p(7)*p(62) - p(217)
      p(262) = p(6)*p(64) - p(200) - p(246) - p(200)
      p(263) = p(11)*p(39) - p(222)
      p(264) = p(2)*p(111) - p(259)
      p(265) = p(2)*p(112) - p(261)
      p(266) = p(12)*p(39) - p(221) - p(264) - p(265)
      p(267) = p(2)*p(98) - p(208) - p(240)
      p(268) = p(6)*p(54) - p(210)
      p(269) = p(7)*p(55) - p(212)
      p(270) = p(2)*p(96) - p(203) - p(223)
      p(271) = p(2)*p(97) - p(207) - p(229)
      p(272) = p(2)*p(101) - p(215) - p(248)
      p(273) = p(2)*p(106) - p(220) - p(257)
      p(274) = p(6)*p(59) - p(220) - p(215) - p(209)
      p(275) = p(7)*p(60) - p(220) - p(215) - p(211)
      p(276) = p(5)*p(66) - p(215) - p(253) - p(249) - p(251) - p(248)
      p(277) = p(6)*p(66) - p(213) - p(252)
      p(278) = p(7)*p(66) - p(214) - p(250)
      p(279) = p(2)*p(104) - p(216) - p(239)
      p(280) = p(2)*p(105) - p(219) - p(248)
      p(281) = p(1)*p(170) - p(244) - p(240) - p(273)
      p(282) = p(10)*p(54) - p(227)
      p(283) = p(10)*p(55) - p(225)
      p(284) = p(2)*p(114) - p(253) - p(276)
      p(285) = p(1)*p(174) - p(250) - p(252) - p(248) - p(276) - p(273)
      p(286) = p(6)*p(68) - p(217) - p(261) - p(251)
      p(287) = p(7)*p(68) - p(218) - p(259) - p(249)
      p(288) = p(2)*p(109) - p(221) - p(257)
      p(289) = p(2)*p(116) - p(262) - p(285)
      p(290) = p(3)*p(110) - p(221) - p(266) - p(259) - p(261) - p(257)
      p(291) = p(6)*p(70) - p(221) - p(266) - p(260)
      p(292) = p(7)*p(70) - p(221) - p(266) - p(258)
      p(293) = p(2)*p(118) - p(266) - p(290)
      p(294) = p(1)*p(183) - p(266) - p(263) - p(290)
      p(295) = p(6)*p(71) - p(265)
      p(296) = p(7)*p(71) - p(264)
      p(297) = p(1)*p(186) - p(270)
      p(298) = p(1)*p(187) - p(277) - p(278) - p(276)
      p(299) = p(2)*p(115) - p(254)
      p(300) = p(1)*p(189) - p(286) - p(287) - p(285) - p(284) - p(298)
      p(301) = p(2)*p(117) - p(263)
      p(302) = p(18)*p(39) - p(282) - p(283) - p(280)
      p(303) = p(2)*p(119) - p(294)
      p(304) = p(3)*p(119) - p(295) - p(296) - p(293)
      p(305) = p(1)*p(194) - p(304) - p(303)
      p(306) = p(40)*p(11)
      p(307) = p(40)*p(12)
      p(308) = p(40)*p(17)
      p(309) = p(40)*p(13)
      p(310) = p(40)*p(14)
      p(311) = p(40)*p(15)
      p(312) = p(40)*p(16)
      p(313) = p(40)*p(18)
      p(314) = p(40)*p(19)
      p(315) = p(40)*p(20)
      p(316) = p(40)*p(21)
      p(317) = p(11)*p(42) - p(310)
      p(318) = p(11)*p(44) - p(307)
      p(319) = p(12)*p(43) - p(309) - p(318)
      p(320) = p(17)*p(42) - p(314)
      p(321) = p(2)*p(125) - p(311)
      p(322) = p(2)*p(126) - p(312)
      p(323) = p(11)*p(48) - p(313)
      p(324) = p(12)*p(42) - p(311) - p(312) - p(307) - p(307)
      p(325) = p(6)*p(79) - p(319)
      p(326) = p(11)*p(54)
      p(327) = p(7)*p(79) - p(319)
      p(328) = p(2)*p(131) - p(315) - p(324)
      p(329) = p(22)*p(29) - p(313) - p(311) - p(326) - p(311)
      p(330) = p(11)*p(55)
      p(331) = p(22)*p(30) - p(313) - p(312) - p(330) - p(312)
      p(332) = p(2)*p(127) - p(309) - p(319)
      p(333) = p(6)*p(83) - p(318)
      p(334) = p(7)*p(83) - p(318)
      p(335) = p(11)*p(52) - p(315) - p(324)
      p(336) = p(2)*p(130) - p(313) - p(323) - p(313)
      p(337) = p(2)*p(133) - p(316)
      p(338) = p(6)*p(77) - p(315) - p(309) - p(322)
      p(339) = p(6)*p(78) - p(312)
      p(340) = p(7)*p(77) - p(315) - p(309) - p(321)
      p(341) = p(7)*p(78) - p(311)
      p(342) = p(11)*p(59) - p(329) - p(338)
      p(343) = p(11)*p(60) - p(331) - p(340)
      p(344) = p(3)*p(130) - p(315) - p(311) - p(312) - p(309) - p(329) - p(338) - p(331) - p(340) - p(328) - p(321) - p(322) - p(311) - p(312)
      p(345) = p(18)*p(42) - p(310) - p(326) - p(330) - p(310)
      p(346) = p(2)*p(132) - p(315) - p(335)
      p(347) = p(6)*p(92) - p(334)
      p(348) = p(7)*p(92) - p(333)
      p(349) = p(3)*p(132) - p(316) - p(315) - p(314) - p(338) - p(347) - p(340) - p(348) - p(336) - p(333) - p(334) - p(316) - p(315) - p(314) - p(316) - p(314) - p(316) - p(314)
      p(350) = p(3)*p(133) - p(315) - p(339) - p(341)
      p(351) = p(4)*p(132) - p(315) - p(344) - p(342) - p(343) - p(332)
      p(352) = p(1)*p(222) - p(316) - p(350)
      p(353) = p(2)*p(134) - p(306)
      p(354) = p(2)*p(135) - p(323)
      p(355) = p(3)*p(134) - p(319)
      p(356) = p(11)*p(53) - p(310) - p(320)
      p(357) = p(2)*p(144) - p(329) - p(338)
      p(358) = p(2)*p(143) - p(324) - p(335)
      p(359) = p(6)*p(81) - p(311) - p(324)
      p(360) = p(2)*p(146) - p(331) - p(340)
      p(361) = p(2)*p(150) - p(344)
      p(362) = p(7)*p(82) - p(312) - p(324)
      p(363) = p(11)*p(65) - p(308)
      p(364) = p(2)*p(137) - p(318)
      p(365) = p(17)*p(45) - p(307)
      p(366) = p(4)*p(134) - p(317)
      p(367) = p(6)*p(96) - p(332)
      p(368) = p(17)*p(54)
      p(369) = p(7)*p(96) - p(332)
      p(370) = p(17)*p(55)
      p(371) = p(2)*p(159) - p(345) - p(349)
      p(372) = p(2)*p(147) - p(313)
      p(373) = p(11)*p(58) - p(315) - p(328)
      p(374) = p(2)*p(148) - p(329) - p(342)
      p(375) = p(6)*p(98) - p(327)
      p(376) = p(2)*p(166) - p(359)
      p(377) = p(14)*p(54) - p(323)
      p(378) = p(2)*p(149) - p(331) - p(343)
      p(379) = p(7)*p(98) - p(325)
      p(380) = p(7)*p(99) - p(311) - p(359)
      p(381) = p(2)*p(167) - p(362)
      p(382) = p(14)*p(55) - p(323)
      p(383) = p(6)*p(100) - p(312) - p(362)
      p(384) = p(11)*p(66) - p(344)
      p(385) = p(6)*p(101) - p(325) - p(343) - p(379)
      p(386) = p(7)*p(101) - p(342) - p(327) - p(375)
      p(387) = p(6)*p(103) - p(313) - p(382)
      p(388) = p(11)*p(67) - p(314)
      p(389) = p(2)*p(152) - p(333)
      p(390) = p(2)*p(153) - p(334)
      p(391) = p(2)*p(154) - p(315) - p(373)
      p(392) = p(1)*p(240) - p(335) - p(373) - p(366)
      p(393) = p(2)*p(155) - p(338) - p(342)
      p(394) = p(2)*p(171) - p(377)
      p(395) = p(2)*p(157) - p(340) - p(343)
      p(396) = p(2)*p(163) - p(350) - p(351)
      p(397) = p(6)*p(95) - p(315) - p(350) - p(340)
      p(398) = p(2)*p(172) - p(382)
      p(399) = p(7)*p(95) - p(315) - p(350) - p(338)
      p(400) = p(11)*p(68) - p(345) - p(349)
      p(401) = p(2)*p(175) - p(380) - p(385)
      p(402) = p(6)*p(106) - p(335) - p(343) - p(396)
      p(403) = p(2)*p(176) - p(383) - p(386)
      p(404) = p(7)*p(106) - p(342) - p(335) - p(396)
      p(405) = p(4)*p(150) - p(328) - p(359) - p(362)
      p(406) = p(11)*p(69) - p(316)
      p(407) = p(2)*p(161) - p(347)
      p(408) = p(2)*p(162) - p(348)
      p(409) = p(11)*p(70) - p(350) - p(351)
      p(410) = p(2)*p(180) - p(397) - p(402)
      p(411) = p(6)*p(110) - p(348)
      p(412) = p(2)*p(181) - p(399) - p(404)
      p(413) = p(7)*p(110) - p(347)
      p(414) = p(6)*p(112) - p(316) - p(398) - p(316)
      p(415) = p(11)*p(71) - p(352)
      p(416) = p(2)*p(184) - p(411)
      p(417) = p(2)*p(185) - p(413)
      p(418) = p(12)*p(71) - p(351) - p(416) - p(417)
      p(419) = p(2)*p(164) - p(320) - p(356)
      p(420) = p(2)*p(165) - p(328) - p(373)
      p(421) = p(2)*p(170) - p(337) - p(392)
      p(422) = p(1)*p(268) - p(359)
      p(423) = p(1)*p(269) - p(362)
      p(424) = p(2)*p(174) - p(345) - p(400)
      p(425) = p(6)*p(102) - p(345) - p(326)
      p(426) = p(7)*p(103) - p(345) - p(330)
      p(427) = p(3)*p(186) - p(364)
      p(428) = p(18)*p(65) - p(354)
      p(429) = p(17)*p(66) - p(361)
      p(430) = p(2)*p(179) - p(350) - p(409)
      p(431) = p(4)*p(166) - p(361) - p(357) - p(422)
      p(432) = p(4)*p(167) - p(361) - p(360) - p(423)
      p(433) = p(2)*p(187) - p(387)
      p(434) = p(14)*p(66) - p(328) - p(405) - p(376) - p(381) - p(373)
      p(435) = p(1)*p(277) - p(387) - p(385) - p(425)
      p(436) = p(1)*p(278) - p(387) - p(386) - p(426)
      p(437) = p(2)*p(177) - p(346) - p(391)
      p(438) = p(2)*p(178) - p(349) - p(400)
      p(439) = p(1)*p(281) - p(396) - p(392) - p(430)
      p(440) = p(21)*p(54) - p(370)
      p(441) = p(21)*p(55) - p(368)
      p(442) = p(2)*p(189) - p(405) - p(434)
      p(443) = p(1)*p(285) - p(402) - p(404) - p(400) - p(434) - p(430)
      p(444) = p(6)*p(116) - p(347) - p(413) - p(403)
      p(445) = p(7)*p(116) - p(348) - p(411) - p(401)
      p(446) = p(2)*p(182) - p(351) - p(409)
      p(447) = p(2)*p(191) - p(414) - p(443)
      p(448) = p(3)*p(183) - p(351) - p(418) - p(411) - p(413) - p(409)
      p(449) = p(6)*p(118) - p(351) - p(418) - p(412)
      p(450) = p(7)*p(118) - p(351) - p(418) - p(410)
      p(451) = p(2)*p(193) - p(418) - p(448)
      p(452) = p(1)*p(294) - p(418) - p(415) - p(448)
      p(453) = p(6)*p(119) - p(417)
      p(454) = p(7)*p(119) - p(416)
      p(455) = p(2)*p(186) - p(363)
      p(456) = p(3)*p(187) - p(385) - p(386) - p(384) - p(435) - p(436) - p(434)
      p(457) = p(2)*p(188) - p(388)
      p(458) = p(4)*p(187) - p(425) - p(426) - p(424)
      p(459) = p(2)*p(190) - p(406)
      p(460) = p(21)*p(66) - p(422) - p(423) - p(420)
      p(461) = p(2)*p(192) - p(415)
      p(462) = p(18)*p(71) - p(440) - p(441) - p(438)
      p(463) = p(2)*p(194) - p(452)
      p(464) = p(3)*p(194) - p(453) - p(454) - p(451)
      p(465) = p(1)*p(305) - p(464) - p(463)

      return

      end subroutine EvPoly





      end module PES_O4_singlet_umn_v1