function [Theta_CM, TOF] = Compute_ScatteringAngle_CM(Vi, Vf, Masses, iProc, Dist)
    

    iTarg = [1,2];
    iProj = [3];
    
    mTarg = sum(Masses(iTarg)); 
    mProj = sum(Masses(iProj));
    mu    = mTarg * mProj / (mTarg + mProj);

    VTargi(:) = Masses(iTarg) * Vi(iTarg,:) ./ mTarg;
    VProji(:) = Masses(iProj) * Vi(iProj,:) ./ mProj;   
    
    vReli_CM  = VProji - VTargi;
    
    
    
    if iProc == 1
        iTarg = [1,2];
        iProj = [3];
    elseif iProc == 2
        iProj = [2];
        iTarg = [1,3];
    elseif iProc == 3
        iProj = [1];
        iTarg = [2,3];
    end
    
    mTarg = sum(Masses(iTarg)); 
    mProj = sum(Masses(iProj));
    mu    = mTarg * mProj / (mTarg + mProj);

    VTargf(:) = Masses(iTarg) * Vf(iTarg,:) ./ mTarg;
    VProjf(:) = Masses(iProj) * Vf(iProj,:) ./ mProj;   
    
    vRelf_CM  = VProjf - VTargf;
    
     
    
    Theta_CM  = acos( dot(vReli_CM, vRelf_CM) / (vecnorm(vReli_CM) * vecnorm(vRelf_CM)) ) / pi * 180.0;

    
    TOF = Dist / norm(VProjf);
    
end